{"version":3,"sources":["page.js"],"names":["define","langx","spa","router","Deferred","Page","Evented","inherit","klassName","init","params","mixin","routeViewer","this","_params","_rvc","document","querySelector","_router","on","proxy","prepare","refresh","curCtx","current","content","previous","route","render","isString","innerHTML","appendChild","trigger","createEvent"],"mappings":";;;;;;;AAAAA,OAAO,CACH,sBACA,QACA,YACD,SAASC,EAAOC,EAAIC,GACJF,EAAMG,SAArB,IAEIC,EAAOJ,EAAMK,QAAQC,QAAQ,CAC7BC,UAAW,UAEXC,KAAM,SAASC,GACXA,EAAST,EAAMU,MAAM,CACjBC,YAAe,MACnB,EAAGF,CAAM,EAETG,KAAKC,QAAUJ,EACfG,KAAKE,KAAOC,SAASC,cAAcP,EAAOE,WAAW,GACrDC,KAAKK,QAAUf,GAERgB,GAAG,SAAUlB,EAAMmB,MAAMP,KAAM,SAAS,CAAC,CACpD,EAEAQ,QAAS,aAKTC,QAAS,WACL,IAAIC,EAASpB,EAAOqB,QAAQ,EAExBC,GADUtB,EAAOuB,SAAS,EAChBH,EAAOI,MAAMC,OAAOL,CAAM,GACpCE,MAAAA,IAGAxB,EAAM4B,SAASJ,CAAO,EACtBZ,KAAKE,KAAKe,UAAYL,GAEtBZ,KAAKE,KAAKe,UAAY,GACtBjB,KAAKE,KAAKgB,YAAYN,CAAO,GAEjCF,EAAOI,MAAMK,QAAQ/B,EAAMgC,YAAY,WAAY,CAC/CN,MAAOJ,EAAOI,MACdF,QAASA,CACb,CAAC,CAAC,EACN,CACJ,CAAC,EAED,OAAOvB,EAAIG,KAAOA,CACtB,CAAC","file":"../page.js","sourcesContent":["define([\r\n    \"skylark-langx/langx\",\r\n    \"./spa\",\r\n    \"./router\"\r\n], function(langx, spa,router) {\r\n    var Deferred = langx.Deferred;\r\n\r\n    var Page = langx.Evented.inherit({\r\n        klassName: \"SpaPage\",\r\n\r\n        init: function(params) {\r\n            params = langx.mixin({\r\n                \"routeViewer\": \"body\"\r\n            }, params);\r\n\r\n            this._params = params;\r\n            this._rvc = document.querySelector(params.routeViewer);\r\n            this._router = router;\r\n\r\n            router.on(\"routed\", langx.proxy(this, \"refresh\"));\r\n        },\r\n\r\n        prepare: function() {\r\n\r\n        },\r\n\r\n        //Refreshes the route\r\n        refresh: function() {\r\n            var curCtx = router.current(),\r\n                prevCtx = router.previous();\r\n            var content = curCtx.route.render(curCtx);\r\n            if (content===undefined || content===null) {\r\n                return;\r\n            }\r\n            if (langx.isString(content)) {\r\n                this._rvc.innerHTML = content;\r\n            } else {\r\n                this._rvc.innerHTML = \"\";\r\n                this._rvc.appendChild(content);\r\n            }\r\n            curCtx.route.trigger(langx.createEvent(\"rendered\", {\r\n                route: curCtx.route,\r\n                content: content\r\n            }));\r\n        }\r\n    });\r\n\r\n    return spa.Page = Page;\r\n});\r\n"]}